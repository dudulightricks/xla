Search.setIndex({"docnames": ["debug", "gpu", "index", "multi_process_distributed", "notes/source_of_recompilation", "runtime", "spmd", "torch_compile"], "filenames": ["debug.rst", "gpu.rst", "index.rst", "multi_process_distributed.rst", "notes/source_of_recompilation.md", "runtime.rst", "spmd.rst", "torch_compile.rst"], "titles": ["Troubleshooting", "How to run with PyTorch/XLA:GPU", "PyTorch/XLA documentation", "How to do <code class=\"docutils literal notranslate\"><span class=\"pre\">DistributedDataParallel</span></code>", "Source of recompilations in torch_xla", "PJRT Runtime", "PyTorch/XLA SPMD User Guide", "TorchDynamo(torch.compile) integration in PyTorch XLA"], "terms": {"note": [0, 1, 2, 3, 4, 5, 6, 7], "inform": [0, 2, 4, 5, 6], "thi": [0, 1, 2, 3, 4, 5, 6, 7], "section": [0, 1, 2, 5, 6], "i": [0, 1, 2, 3, 5, 7], "subject": 0, "remov": [0, 5], "futur": [0, 2, 4, 5], "releas": [0, 1, 2, 3, 5, 6, 7], "softwar": 0, "sinc": [0, 2, 3, 4, 5, 6, 7], "mani": [0, 2, 4, 5, 6], "them": [0, 2, 4, 5, 6], "ar": [0, 3, 4, 5, 6, 7], "peculiar": 0, "given": [0, 2, 3, 4, 6], "intern": [0, 2, 4, 5, 6], "implement": [0, 3, 4, 5, 6, 7], "which": [0, 1, 2, 3, 4, 5, 6, 7], "might": [0, 2, 4], "chang": [0, 2, 3, 4, 6], "befor": [0, 2, 3, 4, 5, 6, 7], "ani": [0, 2, 3, 4, 5, 6], "depth": [0, 5], "we": [0, 1, 2, 3, 4, 5, 6, 7], "want": [0, 4, 5, 6, 7], "do": [0, 1, 2, 4, 5], "instal": [0, 1, 5], "should": [0, 1, 2, 3, 4, 5, 6], "match": [0, 2], "out": [0, 2, 5, 6, 7], "our": [0, 1, 2, 3, 4, 5, 6, 7], "readm": 0, "detial": 0, "avail": [0, 2, 3, 4, 5, 6], "vm": [0, 1, 2, 3, 5], "python": [0, 1, 2, 3, 4, 5, 6, 7], "import": [0, 2, 3, 5, 6, 7], "torch": [0, 1, 2, 3, 4, 6], "torch_xla": [0, 1, 3, 5, 6, 7], "print": [0, 1, 2, 3, 4, 5, 6, 7], "__version__": 0, "2": [0, 1, 2, 3, 5, 6, 7], "1": [0, 1, 2, 3, 5, 6, 7], "0": [0, 1, 2, 3, 4, 5, 6, 7], "cu121": 0, "export": [0, 1, 5], "pjrt_devic": [0, 1, 2, 5, 6], "tpu": [0, 1, 7], "python3": [0, 2, 3, 5], "core": [0, 2, 3, 5, 6, 7], "xla_model": [0, 3, 5, 6, 7], "xm": [0, 2, 3, 6, 7], "t1": [0, 2], "100": [0, 1, 3], "devic": [0, 1, 3, 4, 5, 7], "xla_devic": [0, 2, 3, 5, 6, 7], "t2": 0, "200": 0, "300": 0, "For": [0, 1, 2, 3, 4, 5, 6, 7], "nightli": [0, 3, 6], "git": [0, 1, 3, 5], "clone": [0, 1, 5], "http": [0, 1, 2, 3, 5, 6], "github": [0, 1, 2, 3, 5, 6], "com": [0, 1, 2, 3, 5, 6], "test_train_mp_imagenet": [0, 1, 3, 5], "py": [0, 1, 2, 3, 5, 6], "fake_data": [0, 1, 3, 5, 6], "x": [0, 2, 3, 4, 6], "y": [0, 1, 2, 3, 4, 6], "you": [0, 1, 2, 3, 5, 6, 7], "us": [0, 1, 2, 5, 7], "branch": [0, 4, 5], "rx": 0, "exampl": [0, 1, 2, 4, 5, 7], "r2": [0, 5, 6], "If": [0, 1, 2, 4, 5, 6], "can": [0, 1, 2, 3, 5, 6, 7], "conclud": 0, "correctli": [0, 1], "To": [0, 2, 3, 4, 5, 6], "diagnos": 0, "issu": [0, 2, 3, 5], "counter": [0, 2], "provid": [0, 2, 3, 4, 6, 7], "first": [0, 2, 3, 5, 6], "thing": 0, "when": [0, 2, 3, 5, 6, 7], "model": [0, 3, 4, 5, 6, 7], "slow": 0, "gener": [0, 2, 4, 5, 6], "extrem": 0, "help": [0, 4], "pleas": [0, 1, 2, 3, 5, 6], "try": [0, 4, 6], "includ": [0, 1, 2, 4, 5, 6], "your": [0, 2, 3, 4, 5, 6], "bug": [0, 3, 5], "sent": [0, 2], "u": [0, 1, 4, 5, 7], "have": [0, 1, 2, 3, 4, 5, 6, 7], "enabl": [0, 1, 2, 3, 6], "set": [0, 2, 3, 4, 5, 6, 7], "pt_xla_debug_level": 0, "coupl": [0, 2, 6], "featur": [0, 3, 5, 6], "also": [0, 1, 2, 3, 4, 5, 6, 7], "lower": [0, 4], "level": [0, 6, 7], "slip": 0, "analyz": 0, "summari": 0, "some": [0, 2, 3, 5, 6], "output": [0, 2, 3, 5, 6, 7], "would": [0, 2, 4, 5], "pt": [0, 2, 5], "compiletim": 0, "too": [0, 4], "frequent": 0, "21": 0, "count": [0, 2], "dure": [0, 2, 3, 6, 7], "11": [0, 1, 4], "step": [0, 1, 2, 3, 4, 5, 6, 7], "transferfromdevicetim": 0, "op": [0, 2, 4, 6], "": [0, 1, 2, 3, 5, 6, 7], "aten": [0, 4], "_ctc_loss": 0, "_ctc_loss_backward": 0, "open": [0, 5], "abov": [0, 1, 2, 3, 4, 5, 6, 7], "request": [0, 2, 3, 4, 6], "23": [0, 1], "12": [0, 1, 3, 5, 7], "everi": [0, 2, 4, 5, 6, 7], "caus": [0, 2, 4, 5], "mark_step": [0, 2, 3, 5, 6], "parallel": [0, 2, 5], "loader": [0, 2, 6, 7], "end": [0, 2, 3, 5], "graph": [0, 2, 3, 4, 5, 6, 7], "info": [0, 1, 2, 4], "hash": 0, "c74c3b91b855b2b123f833b0d5f86943": 0, "number": [0, 2, 3, 5], "input": [0, 2, 5, 6], "35": [0, 1, 5], "107": 0, "frame": 0, "trigger": [0, 2, 4], "workspac": 0, "dk3": 0, "1055": 0, "next": [0, 2, 4], "distribut": [0, 3], "parallel_load": [0, 2, 5], "44": 0, "__next__": 0, "32": [0, 2], "train_loop_fn": 0, "train_decoder_only_bas": 0, "48": [0, 3], "start_train": 0, "65": 0, "modul": [0, 2, 3, 6], "73": 0, "post": [0, 2], "size": [0, 1, 2, 4, 5, 6], "548000": 0, "gb": 0, "7": [0, 2, 3, 6, 7], "922460": 0, "alias": 0, "547871": 0, "intermedi": [0, 2, 5], "124478": 0, "program": [0, 2, 4, 6, 7], "028210": 0, "user": [0, 1, 2, 4, 5, 7], "manual": [0, 3], "call": [0, 2, 3, 4, 5, 6, 7], "configur": [0, 1, 2, 5, 6], "batch": [0, 2, 5, 6], "exit": [0, 3], "steptrac": 0, "region": 0, "decid": [0, 4], "access": [0, 1, 2, 4, 5, 6], "often": [0, 4], "due": [0, 5, 6], "log": [0, 1], "valu": [0, 2, 4, 5, 6], "4": [0, 1, 2, 3, 4, 5, 6, 7], "expect": [0, 4, 5, 7], "avoid": [0, 1], "5": [0, 1, 2, 3, 4, 6], "either": [0, 1, 2, 4, 5], "reduc": [0, 2, 3, 5], "frequenc": 0, "add": [0, 2, 3, 4, 7], "see": [0, 1, 2, 3, 4, 5, 6, 7], "pair": 0, "after": [0, 1, 2, 4, 5, 6], "stabil": [0, 5], "onli": [0, 2, 4, 5, 6, 7], "disabl": 0, "effici": [0, 7], "same": [0, 2, 4, 5, 6], "code": [0, 2, 3, 4, 5, 6, 7], "happen": [0, 2, 4, 5], "onc": [0, 2, 4, 6, 7], "keep": [0, 4, 5], "dump": [0, 2], "ir": [0, 4], "hlo": [0, 2], "follow": [0, 1, 2, 3, 4, 5, 6], "compar": [0, 2, 3, 5, 7], "each": [0, 2, 3, 4, 5, 6, 7], "sourc": [0, 2], "differ": [0, 2, 3, 4, 6], "explain": [0, 2, 4], "how": [0, 2, 4, 5, 6], "detail": [0, 2, 4, 5], "put": [0, 2, 3], "line": [0, 2, 3, 4], "met": 0, "short": [0, 4], "contain": [0, 1, 2, 4, 5], "few": [0, 2, 3, 4, 6], "kei": [0, 5, 6], "short_metrics_report": [0, 2], "full": [0, 1, 2, 3], "all": [0, 1, 2, 3, 4, 5, 6], "metrics_report": [0, 2], "like": [0, 2, 3, 4, 5, 6], "time": [0, 1, 2, 4, 5, 6, 7], "spent": 0, "handl": [0, 2, 3, 4, 6], "creat": [0, 3, 5, 6], "destroi": 0, "etc": [0, 1, 2, 4, 6], "term": [0, 4], "percentil": 0, "sampl": [0, 2, 5], "an": [0, 3, 4, 5, 6, 7], "totalsampl": 0, "202": 0, "06m09s401ms746": 0, "001u": 0, "valuer": 0, "778ms572": 0, "062u": 0, "second": [0, 3, 5, 6], "rate": [0, 1, 3], "425201": 0, "001ms32": 0, "778u": 0, "001ms61": 0, "283u": 0, "10": [0, 1, 2, 4, 5, 6, 7], "001ms79": 0, "236u": 0, "20": [0, 1, 2, 3], "001ms110": 0, "973u": 0, "50": 0, "001ms228": 0, "773u": 0, "80": [0, 1], "001ms339": 0, "183u": 0, "90": 0, "001ms434": 0, "305u": 0, "95": 0, "002ms921": 0, "063u": 0, "99": [0, 3], "21s102ms853": 0, "173u": 0, "name": [0, 1, 2, 4, 5, 6], "integ": [0, 2], "track": [0, 6], "statu": 0, "cachedsynctensor": 0, "395": [0, 3], "In": [0, 1, 2, 4, 5, 6, 7], "start": [0, 2, 5], "indic": [0, 2, 4], "context": [0, 2, 4, 5], "switch": [0, 2, 3, 4], "between": [0, 1, 2, 3, 4, 5, 6], "cpu": [0, 1, 3, 4, 6], "potenti": [0, 2, 5], "optim": [0, 1, 2, 3, 4, 5, 7], "area": 0, "oper": [0, 2, 5, 6], "rout": 0, "back": [0, 2, 6], "engin": 0, "thei": [0, 2, 4, 5, 6], "fulli": [0, 5], "qualifi": 0, "c": [0, 2, 4, 5], "namespac": 0, "nonzero": [0, 4], "33": [0, 1, 3, 7], "other": [0, 1, 2, 3, 4, 5, 6], "than": [0, 3, 4, 5], "_local_scalar_dens": 0, "usual": [0, 2], "mean": [0, 2, 3, 4, 5, 6], "miss": [0, 2], "feel": [0, 3], "free": [0, 3], "epoch": [0, 1, 3], "clear_al": 0, "xla_dynamo_debug": 0, "workload": [0, 2, 5, 6], "bottleneck": 0, "resourc": [0, 2], "offici": 0, "tutori": [0, 3, 6], "colab": 0, "notebook": 0, "mnist": [0, 1, 2, 5], "train": [0, 1, 2, 6], "script": [0, 2, 5, 6], "util": [0, 1, 2, 3, 6], "captur": [0, 2], "take": [0, 2, 4, 6], "look": [0, 2, 6], "train_resnet_benchmark": 0, "blob": [0, 3, 5, 6], "master": [0, 2, 3, 5, 6], "_": [0, 3, 5, 7], "behav": 0, "semant": [0, 4], "regular": [0, 2], "share": [0, 1, 2, 5, 6], "interfac": [0, 2, 6], "gpu": [0, 2], "howev": [0, 6], "constraint": [0, 5], "hardwar": [0, 2], "lazi": [0, 4, 6, 7], "evalu": [0, 4], "suggest": [0, 6], "certain": [0, 4], "pattern": [0, 4, 7], "result": [0, 2, 3, 5, 6], "bad": 0, "show": [0, 2, 3, 5], "mind": [0, 5], "yield": [0, 2, 6], "degrad": 0, "recompil": [0, 2], "expens": [0, 4], "automat": [0, 2, 3, 4, 5, 6], "new": [0, 2, 4, 6, 7], "shape": [0, 2, 6], "encount": [0, 5], "within": [0, 2, 6], "huge": [0, 3, 4], "speedup": [0, 7], "rest": [0, 4, 5], "order": [0, 1, 2, 6], "must": [0, 2, 5, 6], "constant": [0, 6], "comput": [0, 1, 2, 4, 5, 6], "across": [0, 2, 3, 5, 6], "host": [0, 1, 2, 3, 5], "possibl": [0, 2, 3, 5], "direct": [0, 5], "indirect": 0, "introduc": [0, 3, 5, 6], "dynam": [0, 7], "mask": [0, 4], "index": [0, 2, 5, 6], "base": [0, 2, 3, 4, 5, 6], "where": [0, 2, 3, 4, 5], "loop": [0, 2, 4, 6], "iter": [0, 2, 6, 7], "thu": [0, 1, 5], "requir": [0, 2, 4, 5, 6], "solut": [0, 4], "low": 0, "variat": 0, "pad": [0, 4], "fix": [0, 7], "don": [0, 3, 4, 5], "t": [0, 2, 3, 4, 5, 6], "nativ": [0, 1, 3, 5, 6], "translat": 0, "transfer": [0, 2, 5, 6], "memori": [0, 1, 3, 4], "lead": 0, "signific": [0, 7], "slowdown": [0, 3], "item": 0, "explicitli": [0, 2, 4], "ask": [0, 4], "unless": [0, 4], "necessari": [0, 2], "most": [0, 2, 5, 7], "checkout": [0, 1], "find": [0, 5], "even": [0, 2, 3, 4, 5], "scalar": [0, 4], "substitut": 0, "control": [0, 2, 6], "flow": 0, "applic": [0, 6], "e": [0, 2, 3, 4, 5, 6], "g": [0, 1, 2, 4, 5, 6], "clip_grad": 0, "norm": 0, "problemat": 0, "impact": [0, 2, 3, 4, 5], "so": [0, 1, 2, 3, 4, 5, 6], "patch": 0, "clip_grad_norm_": 0, "instead": [0, 2, 3, 4, 5, 6, 7], "give": [0, 6], "dramat": 0, "improv": [0, 2, 5, 6, 7], "block": [0, 2, 3, 6], "els": [0, 4], "paramet": [0, 2, 5, 6], "total_norm": 0, "zero": [0, 3, 6], "none": [0, 2, 6], "p": [0, 1, 4, 5], "param_norm": 0, "grad": 0, "norm_typ": 0, "add_": 0, "clip_coef": 0, "max_norm": 0, "1e": [0, 7], "6": [0, 1, 2, 4, 6], "mul_": 0, "data_parallel": 0, "mai": [0, 2, 4, 5, 6], "drop": 0, "last": 0, "make": [0, 1, 2, 3, 4, 5, 7], "sure": [0, 1, 2], "amount": [0, 2, 4], "work": [0, 2, 3, 4, 5, 6, 7], "dataset": [0, 3], "small": [0, 3, 4, 7], "therefor": 0, "better": [0, 2, 4, 5, 6, 7], "those": [0, 3], "case": [0, 2, 5, 6, 7], "opaqu": [0, 2], "alwai": [0, 2, 4, 5, 6], "appear": [0, 2], "contigu": [0, 2], "without": [0, 5, 6], "storag": [0, 1, 2, 3, 6], "network": [0, 2, 5, 6], "stride": 0, "move": [0, 3, 4, 5, 6], "save": [0, 3, 6], "directli": [0, 2, 3, 4, 5, 6], "load": [0, 3, 5], "were": [0, 2, 4], "from": [0, 3, 6, 7], "unavail": [0, 2], "fail": [0, 2, 6], "let": [0, 2, 5, 7], "machin": [0, 1, 5, 6], "care": [0, 2, 4], "taken": [0, 2, 3, 4, 6], "type": [0, 1, 2, 3, 5, 6], "doe": [0, 2, 4, 5, 6], "preserv": [0, 2], "view": [0, 2], "relationship": [0, 2], "reconstruct": 0, "copi": [0, 2, 5], "return": [0, 2, 3, 4, 6, 7], "deep": 0, "shallow": 0, "weight": [0, 2, 6], "one": [0, 2, 3, 4, 5, 6, 7], "anoth": [0, 2, 4], "ty": 0, "done": [0, 2, 4], "otherwis": [0, 2, 4], "two": [0, 2, 4, 5, 6], "independ": [0, 2, 5], "made": [0, 4, 6], "But": [0, 2, 4], "submit": 0, "addit": [0, 1, 2, 3, 5], "doesn": [0, 2, 4], "_xlac": [0, 4], "_get_xla_tensors_text": [0, 4], "re": [0, 2, 4, 5], "_get_xla_tensors_hlo": 0, "function": [0, 2, 6, 7], "prior": [0, 6], "alreadi": [0, 1, 2, 3, 4, 6], "materi": [0, 2, 4, 6], "There": [0, 2, 3, 4, 6, 7], "behavior": [0, 2, 5], "stack": [0, 2, 4, 6], "degre": 0, "xla_ir_debug": 0, "trace": [0, 2, 3, 4, 5, 6, 7], "node": [0, 4, 6], "henc": [0, 7], "allow": [0, 2, 6], "wa": [0, 2, 4, 5, 6], "respons": [0, 6, 7], "xla_hlo_debug": [0, 2], "_xla_ir": 0, "activ": [0, 2, 3], "propag": 0, "metadata": 0, "xla_save_tensors_fil": 0, "path": [0, 1, 2, 3, 4], "file": [0, 2, 3, 5], "becom": [0, 2, 4, 5, 6], "realli": [0, 4, 7], "big": [0, 4], "option": [0, 2, 5, 6], "left": 0, "long": [0, 3, 4], "append": 0, "clean": [0, 7], "sheet": 0, "xla_save_tensors_fmt": 0, "format": [0, 2, 7], "store": [0, 2], "_xla_save_tensor": 0, "text": 0, "default": [0, 1, 2, 3, 5, 6], "dot": 0, "graphviz": 0, "xla_flag": 0, "xla_dump_to": 0, "tmp": [0, 3], "dir_nam": 0, "unoptim": 0, "optimz": 0, "per": [0, 1, 2, 3, 5, 7], "xla_metrics_fil": 0, "local": [0, 1, 2, 5, 6], "exist": [0, 2, 5, 6, 7], "xla_save_hlo_fil": 0, "error": [0, 2], "offend": 0, "xla_sync_wait": 0, "forc": [0, 4, 5], "sync": [0, 1, 2], "wait": [0, 2], "its": [0, 2, 3, 5, 6, 7], "complet": [0, 2, 6], "xla_use_eager_debug_mod": 0, "eagerli": [0, 2, 4], "bypass": 0, "overal": 0, "lot": [0, 2, 4], "slower": [0, 3], "usag": [0, 1, 2, 3, 4, 6], "higher": [0, 6], "optimizaiton": 0, "skip": [0, 7], "tf_cpp_log_thread_id": 0, "tf": [0, 4], "thread": [0, 2, 5, 6], "id": [0, 1, 2, 5], "multithread": 0, "process": [0, 1, 3, 5], "tf_cpp_vmodul": 0, "vlog": 0, "form": [0, 4, 5, 6], "tf_cpp_min_log_level": 0, "messag": [0, 2], "turn": 0, "warn": 0, "tf_vlog": 0, "tensorflow": [0, 2, 4, 5], "xla_dump_hlo_graph": 0, "part": [0, 2, 5], "runtim": [0, 1, 3, 6], "rais": 0, "xla_util": 0, "cc": 0, "record": [0, 2], "save1": 0, "xla_graph_executor": 0, "pjrt_computation_cli": 0, "3": [0, 1, 2, 3, 6, 7], "pr": [0, 3], "repo": [0, 1, 2, 6], "dir": 0, "pytorch_test_with_slow": 0, "test_torch": 0, "k": 0, "test_put_xla_uint8": 0, "command": [0, 2, 3, 5], "need": [0, 1, 2, 3, 4, 5, 6], "torch_test_devic": 0, "pytorch_test_bas": 0, "compil": [1, 4, 5, 6], "acceler": [1, 2, 5, 6], "doc": [1, 4, 5], "go": [1, 2, 6], "over": [1, 2, 3, 5, 6], "basic": [1, 3, 4], "nvidia": [1, 6], "attach": [1, 6], "cloud": [1, 2, 5, 6, 7], "googl": [1, 2, 5, 6], "cuda": [1, 2, 4, 5, 6], "driver": 1, "current": [1, 2, 3, 4, 5, 6, 7], "publish": 1, "prebuilt": 1, "imag": [1, 3, 4, 5], "cuda11": 1, "8": [1, 2, 4, 5, 6, 7], "recommend": [1, 2, 5, 6], "correspond": [1, 2, 3, 6], "config": 1, "list": [1, 2, 6], "refer": [1, 2, 3, 5], "sudo": [1, 5], "pull": [1, 3], "central1": 1, "pkg": 1, "dev": [1, 3], "nightly_3": 1, "8_cuda_12": 1, "toolkit": 1, "datacent": 1, "latest": 1, "guid": [1, 2, 3, 5], "html": [1, 3, 5], "curl": 1, "fssl": 1, "io": [1, 3, 5], "libnvidia": 1, "gpgkei": 1, "gpg": 1, "dearmor": 1, "o": [1, 3, 5], "usr": 1, "keyr": 1, "l": 1, "stabl": [1, 3, 5], "deb": 1, "sed": 1, "sign": 1, "tee": 1, "apt": 1, "d": [1, 2, 4, 6], "get": [1, 2, 3, 4, 5], "updat": [1, 2, 4, 6], "ctk": 1, "systemctl": 1, "restart": [1, 5], "shm": 1, "16g": 1, "net": [1, 5], "bin": 1, "bash": [1, 3], "exec": 1, "awk": 1, "nr": 1, "visibl": [1, 2, 4], "smi": 1, "verifi": 1, "root": [1, 2, 4], "20ab2c7a2d06": 1, "dec": 1, "06": 1, "24": 1, "29": [1, 3, 7], "2022": 1, "510": 1, "47": 1, "03": 1, "version": [1, 5, 6], "persist": [1, 2, 6], "m": [1, 3, 4], "bu": 1, "disp": 1, "A": [1, 2, 4, 5, 6], "volatil": 1, "uncorr": 1, "ecc": 1, "fan": 1, "temp": 1, "perf": [1, 4], "pwr": 1, "cap": 1, "mig": 1, "tesla": 1, "v100": 1, "sxm2": 1, "off": 1, "00000000": 1, "00": [1, 3], "04": [1, 7], "n": [1, 2, 6], "36c": 1, "p0": 1, "38w": 1, "300w": 1, "0mib": 1, "16384mib": 1, "gi": 1, "ci": 1, "pid": 1, "No": [1, 4, 5], "found": [1, 5], "ld_library_path": 1, "account": 1, "echo": 1, "link": 1, "bashrc": 1, "lib64": 1, "pip3": 1, "whl": 1, "googleapi": 1, "cp310": 1, "manylinux_2_28_x86_64": 1, "here": [1, 2, 3, 4, 6, 7], "below": [1, 4, 5, 6], "imagenet": 1, "gpu_num_devic": [1, 5], "recurs": [1, 3], "test": [1, 3, 5, 6], "prepar": 1, "data": [1, 2, 4, 5, 7], "begin": [1, 6], "38": 1, "loss": [1, 2, 3, 5, 6, 7], "89059": 1, "82": 1, "globalr": 1, "13": [1, 2, 3, 5], "79297": 1, "117": 1, "16": [1, 2, 3], "45": 1, "84": 1, "36": 1, "40": [1, 3], "43628": 1, "281": 1, "49": [1, 7], "43": [1, 7], "60": [1, 3], "83108": 1, "346": 1, "88": [1, 6], "108": 1, "99023": 1, "373": 1, "62": [1, 7], "132": 1, "56": 1, "92699": 1, "384": 1, "152": 1, "14": 1, "02": [1, 3], "120": 1, "68816": 1, "388": 1, "169": 1, "09": 1, "veri": [1, 2, 4], "reus": [1, 2, 6], "rule": 1, "modifi": [1, 6, 7], "insid": [1, 6], "more": [1, 2, 4, 5, 6], "cd": [1, 3], "use_cuda": 1, "xla_cuda": 1, "been": [1, 2, 4, 5, 6], "successfulli": 1, "packag": [2, 3], "learn": [2, 5], "connect": [2, 5, 6], "framework": [2, 4, 6], "troubleshoot": 2, "distributeddataparallel": [2, 5], "pjrt": [2, 6], "torchdynamo": 2, "integr": 2, "describ": [2, 3, 6], "just": [2, 3, 4, 5, 6], "randn": [2, 3, 5, 6, 7], "familiar": 2, "initi": [2, 3, 5, 6], "depend": [2, 4], "environ": [2, 3, 5, 6], "perform": [2, 3, 6, 7], "ad": [2, 4, 7], "togeth": [2, 3, 5, 6], "t0": 2, "Or": [2, 4, 5], "matrix": 2, "multipli": 2, "mm": 2, "neural": 2, "l_in": 2, "linear": [2, 3, 5, 6], "nn": [2, 3, 5, 6, 7], "l_out": 2, "floattensor": 2, "throw": 2, "build": [2, 3], "convert": [2, 3], "specif": [2, 3], "The": [2, 3, 4, 5, 6, 7], "snippet": [2, 6], "highlight": 2, "loss_fn": [2, 3, 5, 6, 7], "nllloss": 2, "sgd": [2, 3, 5, 7], "lr": [2, 3, 5, 7], "momentum": 2, "target": [2, 4, 5, 6, 7], "train_load": [2, 6], "zero_grad": [2, 3, 5, 6], "backward": [2, 3, 5, 7], "easi": [2, 4, 5], "definit": [2, 4], "dataload": [2, 3, 6], "acquir": 2, "mark": 2, "execut": [2, 3, 4, 5, 6, 7], "pl": [2, 5, 6], "xla_multiprocess": [2, 3, 5], "xmp": [2, 3, 5], "def": [2, 3, 5, 6, 7], "_mp_fn": [2, 5], "mp_device_load": 2, "mpdeviceload": [2, 6], "optimizer_step": [2, 3], "__name__": [2, 3, 5], "__main__": [2, 3, 5], "spawn": [2, 3, 5], "arg": [2, 3], "three": [2, 6], "previou": [2, 4, 5, 6], "abl": [2, 4, 6], "assign": [2, 6], "v4": [2, 5, 6, 7], "being": [2, 3], "up": [2, 4, 5, 6], "own": [2, 3], "becaus": [2, 5, 6], "v2": 2, "v3": 2, "check": [2, 6], "onto": 2, "wrap": [2, 3, 6], "It": [2, 3, 4, 6, 7], "preload": 2, "overlap": [2, 6, 7], "batches_per_execut": 2, "consolid": [2, 3], "gradient": [2, 3, 6], "pretti": [2, 3, 4], "much": [2, 4, 5, 7], "all_reduce_gradi": 2, "remain": [2, 4, 6], "retriev": [2, 4, 6, 7], "ha": [2, 4, 5, 6], "parent": 2, "multiprocess": [2, 5], "setup": [2, 3], "talk": 2, "about": [2, 4, 5], "bit": 2, "basi": 2, "gcloud": [2, 5], "project": [2, 5], "howto": 2, "focu": [2, 4], "perspect": [2, 5], "assum": [2, 3, 4, 6], "train_mnist_xla": 2, "ssh": [2, 5], "tpuvm": [2, 5, 6], "now": [2, 4, 5, 6], "scp": [2, 5], "alpha": [2, 5], "zone": [2, 5], "worker": [2, 3, 5, 6], "outsid": 2, "underli": 2, "infrastructur": 2, "awar": 2, "global": [2, 5, 6], "topologi": [2, 6], "ordin": 2, "cross": [2, 6], "commun": [2, 5, 6, 7], "regard": [2, 7], "resnet50": [2, 5, 7], "fakedata": 2, "though": [2, 3], "act": 2, "what": 2, "uniqu": [2, 4], "launch": [2, 3, 7], "immedi": [2, 6], "hand": 2, "until": [2, 6], "defer": 2, "separ": [2, 3, 7], "fuse": 2, "invis": 2, "caller": 2, "construct": [2, 3, 6], "send": [2, 5, 6], "synchron": [2, 5, 6], "insert": 2, "barrier": [2, 5], "design": [2, 5, 7], "paper": [2, 6], "datatyp": 2, "fact": 2, "float": [2, 4], "doubl": [2, 4], "xla_use_bf16": 2, "xla_downcast_bf16": 2, "variabl": [2, 4, 5], "By": [2, 4, 5], "both": [2, 3, 4, 5, 6, 7], "float32": 2, "map": 2, "bf16": 2, "primit": 2, "develop": [2, 3, 6, 7], "report": 2, "regardless": 2, "actual": [2, 3, 4, 6], "convers": [2, 4], "unit": [2, 3, 6], "represent": [2, 6], "expos": [2, 5, 6], "unlik": [2, 6], "adjust": 2, "wai": [2, 3, 4, 5, 6, 7], "again": 2, "appreci": 2, "accommod": 2, "transit": 2, "recreat": 2, "destin": 2, "previous": 2, "state_dict": [2, 3, 6], "limit": [2, 5, 6], "footprint": 2, "serial": [2, 5], "xser": 2, "stream": 2, "restor": 2, "load_state_dict": [2, 6], "under": [2, 3, 5, 6], "consum": [2, 4], "disk": 2, "significantli": [2, 5], "still": [2, 3, 4, 5, 6], "occur": 2, "opt": 2, "through": [2, 4, 6], "initialize_cach": 2, "xr": [2, 5, 6], "your_cache_path": 2, "readonli": 2, "fals": [2, 3, 6], "specifi": [2, 3, 6], "whether": 2, "write": [2, 6], "mount": 2, "int": [2, 4, 5, 6], "instanc": [2, 3, 6], "virtual": 2, "device_count": [2, 6], "address": [2, 5, 6], "pend": 2, "dispatch": [2, 6], "progress": 2, "best": [2, 7], "practic": [2, 4, 5], "6751": 2, "device_typ": 2, "str": [2, 6], "select": [2, 5, 6], "local_process_count": 2, "local_device_count": 2, "total": [2, 4], "addressable_device_count": 2, "global_device_count": 2, "global_runtime_device_count": [2, 6], "especi": [2, 5, 6, 7], "world_siz": [2, 3, 5, 6], "particip": [2, 5], "job": [2, 7], "global_ordin": 2, "rang": [2, 5, 6], "guarante": 2, "predict": 2, "nor": 2, "local_ordin": 2, "get_master_ip": 2, "ip": [2, 5, 6], "backend": [2, 4, 5, 6, 7], "discoveri": 2, "string": [2, 6], "use_spmd": [2, 6], "auto": [2, 3], "bool": 2, "is_spmd": [2, 6], "devkind": 2, "custom": [2, 3, 4, 6], "deprec": 2, "xla_device_hw": 2, "real": [2, 7], "is_master_ordin": 2, "true": [2, 3, 4, 5, 6], "replic": [2, 6], "while": [2, 3, 4], "num_host": 2, "boolean": 2, "all_reduc": 2, "reduce_typ": 2, "scale": [2, 5, 6, 7], "group": [2, 3, 5], "pin_layout": 2, "inplac": 2, "One": [2, 3, 6], "reduce_sum": 2, "reduce_mul": 2, "reduce_and": 2, "reduce_or": 2, "reduce_min": 2, "reduce_max": 2, "appli": [2, 3, 6], "repres": [2, 4, 5], "replica": [2, 5, 6], "defin": [2, 6], "pin": 2, "pine": 2, "prevent": [2, 6, 7], "corrupt": 2, "slightli": 2, "unpin": 2, "hlomodul": 2, "mix": [2, 6], "constrain": [2, 5], "pass": [2, 3, 5, 6], "hold": [2, 6], "tupl": [2, 4, 6], "itself": [2, 3], "all_gath": [2, 5], "dim": 2, "gather": [2, 6], "along": [2, 3, 6], "dimens": [2, 6], "all_to_al": 2, "split_dimens": 2, "concat_dimens": 2, "split_count": 2, "alltoal": 2, "www": 2, "org": [2, 3, 5], "operation_semant": 2, "upon": 2, "split": 2, "concat": 2, "add_step_closur": 2, "closur": 2, "run_async": 2, "ones": [2, 4], "consol": 2, "tensorboard": 2, "content": 2, "intermediari": 2, "inspect": 2, "point": [2, 4], "typic": 2, "ensur": [2, 4, 6], "live": [2, 4], "argument": [2, 3, 7], "queu": 2, "sequenti": 2, "advis": 2, "throttl": 2, "event": 2, "callabl": [2, 3], "asynchron": [2, 6], "wait_device_op": 2, "async": [2, 7], "whose": 2, "empti": 2, "optimizer_arg": 2, "parallelload": [2, 6], "dataparallel": 2, "support": [2, 3, 4, 5, 6, 7], "dict": [2, 3], "dictionari": 2, "file_or_path": 2, "master_onli": [2, 3], "global_mast": 2, "nest": [2, 3], "combin": [2, 4, 6], "object": 2, "overrid": 2, "locat": 2, "flag": 2, "main": [2, 5, 6], "hang": 2, "rendezv": 2, "tag": [2, 5], "payload": [2, 5], "b": [2, 4, 5, 6, 7], "mesh": [2, 5], "client": [2, 5], "reach": 2, "xrt": 2, "server": [2, 5], "effect": 2, "alia": 2, "xla_rendezv": 2, "join": 2, "byte": 2, "exchang": 2, "posit": 2, "mesh_reduc": 2, "reduce_fn": 2, "reduct": 2, "receiv": 2, "come": [2, 4, 6], "set_rng_stat": 2, "seed": 2, "random": [2, 5], "state": [2, 3], "rng": [2, 5], "get_rng_stat": 2, "get_memory_info": 2, "memoryinfo": 2, "get_stablehlo": 2, "stablehlo": 2, "whole": [2, 4, 7], "todo": 2, "lsy323": 2, "investig": [2, 3], "infer": [2, 5, 6], "straightforward": 2, "identifi": [2, 6], "env": [2, 5, 6], "var": [2, 6], "get_stablehlo_bytecod": 2, "bytecod": [2, 7], "class": [2, 3, 6], "batchdim": 2, "loader_prefetch_s": 2, "device_prefetch_s": 2, "host_to_device_transfer_thread": 2, "input_shard": [2, 6], "background": [2, 6], "upload": [2, 6], "th": [2, 6], "len": [2, 6], "max": [2, 4, 6], "capac": 2, "queue": 2, "deposit": 2, "shardingspec": [2, 6], "shard": 2, "spec": 2, "compat": [2, 5, 6], "per_device_load": [2, 6], "structur": [2, 3, 6], "resid": [2, 6], "fn": 2, "nproc": [2, 5], "daemon": 2, "start_method": 2, "At": 2, "moment": 2, "maximum": 2, "creation": 2, "method": [2, 5, 6], "mark_shard": [2, 6], "union": [2, 6], "xlashardedtensor": 2, "partition_spec": [2, 6], "use_dynamo_custom_op": 2, "annot": [2, 6], "partit": 2, "xlatensor": [2, 6], "spmdpartition": [2, 6], "param": [2, 6], "logic": [2, 4, 6], "device_mesh": [2, 6], "axi": [2, 6], "rank": [2, 3, 5, 6], "mesh_shap": [2, 6], "ax": [2, 6], "row": 2, "wise": 2, "8x10": 2, "column": 2, "dynamo_custom_op": 2, "dynamo": [2, 7], "variant": [2, 4], "recogniz": 2, "traceabl": 2, "num_devic": [2, 6], "device_id": [2, 6], "np": [2, 6], "arrai": [2, 6], "clear_shard": 2, "clear": 2, "cast": 2, "set_global_mesh": 2, "get_global_mesh": 2, "ndarrai": 2, "axis_nam": [2, 6], "ravel": 2, "reshap": 2, "fill": 2, "element": [2, 4], "sequenc": 2, "Its": 2, "length": [2, 4], "get_xla_supported_devic": 2, "get_logical_mesh": [2, 6], "ordereddict": [2, 6], "hybridmesh": [2, 6], "ici_mesh_shap": [2, 6], "dcn_mesh_shap": [2, 6], "hybrid": 2, "ici": 2, "dcn": [2, 6], "increas": 2, "intens": 2, "mdl": 2, "inner": [2, 3, 6], "outer": [2, 3, 6], "slice": [2, 6], "fsdp": 2, "xla_shard": 2, "minibatch": 2, "eager_mod": 2, "mode": [2, 3, 4, 6], "eager": [2, 3, 4], "func": 2, "exact": 2, "metric": [2, 3], "counter_nam": 2, "metric_nam": 2, "counter_valu": 2, "metric_data": 2, "total_sampl": 2, "accumul": 2, "retain": 2, "circular": 2, "buffer": 2, "sum": [2, 3], "document": [3, 5], "further": [3, 6], "against": 3, "approach": [3, 4, 6], "abil": [3, 4], "api": [3, 4, 5, 7], "And": [3, 4, 6], "experiment": [3, 5, 6, 7], "who": 3, "ddp": [3, 5, 6], "know": [3, 4], "singl": [3, 4, 6, 7], "xla_backend": [3, 5, 6], "init": [3, 5, 7], "similar": [3, 5], "nccl": 3, "gloo": [3, 5, 6], "dist": [3, 5, 6], "init_process_group": [3, 5, 6], "new_rank": 3, "get_ordin": [3, 5], "xrt_world_siz": [3, 5], "gradient_as_bucket_view": [3, 5], "wrapper": [3, 6], "ddp_model": 3, "final": [3, 6], "launcher": 3, "demo_fn": 3, "everyth": [3, 4], "experi": [3, 5, 6], "touch": [3, 6], "plu": 3, "five": 3, "sy": 3, "tempfil": 3, "master_addr": [3, 5], "localhost": [3, 5], "master_port": [3, 5], "12355": [3, 5, 6], "cleanup": 3, "destroy_process_group": 3, "toymodel": 3, "__init__": 3, "self": 3, "super": [3, 7], "net1": 3, "1000000": 3, "relu": 3, "net2": 3, "forward": [3, 7], "demo_bas": 3, "assert": [3, 6], "f": [3, 6], "run": [3, 4, 5, 7], "graident_as_bucket_view": 3, "mseloss": [3, 5], "001": [3, 5], "label": 3, "run_demo": 3, "collect": [3, 5, 6, 7], "num_epoch": [3, 5], "tot": 3, "statist": 3, "produc": [3, 4], "median": 3, "90th": 3, "std": 3, "cv": 3, "418": 3, "54": 3, "419": 3, "22": 3, "430": 3, "9": [3, 4], "76": 3, "97": 3, "407": 3, "39": 3, "seem": 3, "reason": [3, 5], "extra": 3, "overhead": [3, 5, 7], "test_train_mp_mnist": [3, 5], "17864": 3, "19": [3, 7], "20108": 3, "96": 3, "24351": 3, "74": 3, "5866": 3, "83": 3, "10701": 3, "11770": 3, "14313": 3, "78": 3, "3102": 3, "92": 3, "41": [3, 7], "round": 3, "heavili": [3, 7], "sens": 3, "hard": [3, 4, 7], "amort": 3, "logdir": 3, "observ": [3, 5], "converg": 3, "achiev": 3, "high": 3, "accuraci": 3, "caution": 3, "interest": 3, "known": 3, "enforc": [3, 4], "crash": 3, "xlafullyshardeddataparallel": 3, "my_modul": 3, "adam": 3, "0001": 3, "individu": [3, 6], "layer": [3, 6], "leftov": 3, "arxiv": 3, "ab": 3, "1910": 3, "02054": 3, "via": [3, 5, 6], "reshard_after_forward": 3, "test_train_mp_mnist_fsdp_with_ckpt": 3, "test_train_mp_imagenet_fsdp": 3, "larg": [3, 4, 5, 6], "cannot": [3, 4], "fit": 3, "interleav": 3, "submodul": 3, "fsdpvitmodel": 3, "ronghanghu": 3, "vit_10b_fsdp_exampl": 3, "run_vit_train": 3, "simpl": [3, 5], "checkpoint_modul": 3, "checkpoint": [3, 5], "3524": 3, "auto_wrap_polici": 3, "size_based_auto_wrap_polici": 3, "polici": [3, 6], "larger": [3, 7], "100m": 3, "transformer_auto_wrap_polici": 3, "transform": [3, 6], "architectur": [3, 5], "conv2d": 3, "partial": [3, 4, 6], "transformer_layer_cl": 3, "addition": 3, "auto_wrapper_cal": 3, "remateri": 3, "lambda": 3, "kwarg": [3, 6], "latter": 3, "resum": 3, "get_shard_metadata": 3, "consolidate_sharded_model_checkpoint": 3, "stitch": 3, "ckpt": 3, "shard_metadata": 3, "ckpt_path": 3, "pth": 3, "tool": 3, "consolidate_sharded_ckpt": 3, "ckpt_prefix": 3, "your_sharded_checkpoint_fil": 3, "ckpt_suffix": 3, "_rank": 3, "inspir": 3, "mostli": [3, 5], "fairscal": 3, "fullyshardeddataparallel": 3, "readthedoc": 3, "en": 3, "biggest": [3, 7], "explicit": 3, "resort": 3, "newer": 3, "wheel": 3, "around": [3, 4, 5, 6], "98": 3, "batch_siz": [3, 5, 6], "drop_last": 3, "use_nested_fsdp": 3, "use_gradient_checkpoint": 3, "final_ckpt": 3, "75": 3, "download": 3, "1k": 3, "datadir": 3, "test_set_batch_s": 3, "64": [3, 6, 7], "eval_interv": 3, "128": [3, 5, 6], "num_warmup_epoch": 3, "lr_scheduler_divide_every_n_epoch": 3, "30": [3, 5], "lr_scheduler_divisor": 3, "residu": 3, "entir": [3, 5], "algorithm": 3, "vision": 3, "vit": 3, "xla": [4, 5], "static": 4, "word": 4, "hurt": 4, "understand": 4, "debug": 4, "normal": [4, 5, 6], "pov": 4, "sai": 4, "assur": 4, "magic": 4, "gone": 4, "good": [4, 6], "coverag": 4, "aim": 4, "explan": 4, "common": [4, 5, 6], "rid": 4, "mainli": 4, "problem": 4, "beginn": 4, "propos": 4, "reli": 4, "impract": 4, "assumpt": 4, "ye": 4, "sentenc": 4, "vari": [4, 5], "ll": 4, "bucket": [4, 6], "kinda": 4, "anti": 4, "pytorch": [4, 5], "frontend": 4, "matter": 4, "workaround": 4, "okai": 4, "teach": 4, "enough": [4, 6], "theoret": 4, "trade": 4, "less": [4, 5, 7], "faster": [4, 5, 7], "speed": [4, 7], "well": [4, 5, 6], "sort": 4, "obviou": 4, "shown": [4, 5], "s64": 4, "num_output": 4, "mul": 4, "although": [4, 5], "inde": 4, "_get_xla_tensor_dimension_s": 4, "commonli": 4, "dtype": [4, 5], "cut": 4, "correct": 4, "wrong": 4, "wors": 4, "probabl": 4, "upper": 4, "nit": 4, "simplic": 4, "rand": 4, "solv": 4, "world": [4, 5, 6, 7], "kept": 4, "earli": 4, "accessor": 4, "2d": [4, 6], "implicitli": 4, "overload": 4, "easili": [4, 7], "explod": 4, "easier": 4, "cheap": 4, "ve": 4, "hoc": 4, "think": 4, "verison": 4, "bla": 4, "blabla": 4, "interpret": 4, "proce": 4, "choic": 4, "multipl": [4, 6, 7], "wide": 4, "adopt": 4, "uglier": 4, "win": 4, "pars": 4, "statement": 4, "torchscript": 4, "somehow": 4, "merg": 4, "lazili": [4, 6], "properli": 4, "haven": 4, "thought": 4, "non": [4, 6], "trivial": 4, "effort": [4, 6], "side": 4, "That": 4, "why": 4, "hit": 4, "bandwidth": 4, "automag": 4, "gold": 4, "smart": 4, "trick": 4, "tbh": 4, "longer": 4, "sometim": 4, "unawar": 4, "hope": 4, "smash": 4, "ideal": [4, 7], "blocker": 4, "ahead": 4, "nnc": 4, "symbol": 4, "concret": 4, "kernel": 4, "exactli": 4, "transpos": 4, "With": [4, 5, 7], "brian": 4, "hirsh": 4, "bdhirsh": 4, "question": 4, "comment": [4, 6], "worth": 4, "stick": 4, "torch_warn": 4, "yea": 4, "tell": 4, "hei": 4, "won": 4, "blaze": 4, "fast": 4, "isn": [4, 6], "rewrit": [4, 6], "devirtu": 4, "v": [4, 5], "right": [4, 7], "sound": 4, "great": 4, "carri": [4, 6], "truth": 4, "As": 4, "irvalu": 4, "discrep": 4, "followup": 4, "mention": [4, 7], "1000": 4, "my": [4, 6], "properti": 4, "presenc": 4, "get_dimention_s": 4, "didn": 4, "altern": [4, 5], "condit": 4, "middl": [4, 5], "exponenti": 4, "blowup": 4, "smaller": 4, "fewer": 4, "opportun": 4, "recogn": [4, 7], "could": [4, 5, 6], "break": 4, "feasibl": 4, "annoi": 4, "z": [4, 6], "subgraph": 4, "wasn": 4, "materiz": 4, "involv": [4, 6], "combo": 4, "migrat": 5, "jax": 5, "public": 5, "renam": 5, "regist": [5, 6], "torchrun": [5, 6], "init_method": [5, 6], "plugin": 5, "xpu": 5, "neuron": 5, "continu": [5, 7], "xrt_tpu_config": 5, "libtpu": 5, "thousand": 5, "preview": 5, "On": [5, 6], "safe": 5, "broadcast": 5, "broadcast_master_param": 5, "manual_se": 5, "pjrt_backend": 5, "These": [5, 6], "diff": 5, "42": 5, "confirm": 5, "localservic": 5, "51011": 5, "grpc": 5, "torchbench": 5, "2048": [5, 6], "chip": 5, "read": 5, "central2": 5, "256": 5, "tpu_process_bound": 5, "tpu_visible_chip": 5, "r1": 5, "preinstal": 5, "docker_imag": 5, "gcr": 5, "authent": 5, "privat": 5, "gcp": 5, "repositori": 5, "auth": 5, "rm": 5, "privileg": 5, "simpli": [5, 6], "nnode": [5, 6], "num_gpu_devic": 5, "pjrt_distribut": 5, "physic": [5, 6], "number_gpu_vm": [5, 6], "node_rank": [5, 6], "current_node_rank": 5, "nproc_per_nod": [5, 6], "number_local_gpu_devic": 5, "rdzv_endpoint": [5, 6], "internal_ip_address": 5, "port": [5, 6], "multinode_train": 5, "endpoint": [5, 6], "omit": [5, 6], "machine_0": 5, "machine_1": 5, "machine_0_internal_ip_address": [5, 6], "ident": 5, "page": 5, "interchang": 5, "subtl": 5, "importantli": 5, "latenc": 5, "deseri": 5, "gain": 5, "interact": 5, "profil": 5, "plan": 5, "simpler": 5, "xla_dist": 5, "sdk": 5, "reimplement": 5, "enhanc": 5, "substanti": 5, "consist": [5, 6], "servic": 5, "unreli": 5, "inbound": 5, "failur": 5, "impos": 5, "unwant": 5, "permit": 5, "subset": 5, "old": 5, "alter": 5, "consid": 5, "all_gather_object": 5, "new_group": 5, "subgroup": 5, "reliabl": 5, "md": 5, "strongli": 5, "queri": 5, "_all_gath": 5, "tensor": [5, 6, 7], "int32": 5, "zeros_lik": 5, "get_world_s": 5, "averag": 5, "task": 5, "175": 5, "chart": 5, "breakdown": 5, "tfrt": 5, "legaci": 5, "streamexecutor": 5, "tpu_legaci": 5, "comparison": [5, 6], "discuss": 6, "gspmd": 6, "illustr": 6, "system": 6, "ml": 6, "proper": 6, "hint": 6, "figur": 6, "strategi": 6, "suit": 6, "popular": 6, "shift": 6, "unlock": 6, "advanc": 6, "b8b484515a97f74e013dcf38125c44d53a41f011": 6, "l214": 6, "replac": 6, "mechan": 6, "later": 6, "src": 6, "invok": [6, 7], "rfc": 6, "numpi": 6, "m1_shard": 6, "isinst": 6, "techniqu": 6, "simplelinear": 6, "fc1": 6, "enumer": 6, "sharidng": 6, "spatial": 6, "ouput": 6, "cluster": 6, "interconnect": 6, "deriv": 6, "sub": 6, "abstract": 6, "nad": 6, "tile": 6, "intend": 6, "manipul": 6, "nice": 6, "arrang": 6, "center": 6, "box": 6, "multislic": 6, "accept": 6, "denot": 6, "input_tensor": 6, "origin": 6, "evenli": 6, "among": 6, "equival": 6, "desir": 6, "demonstr": 6, "3d": 6, "two_d_partially_repl": 6, "two_d_fully_shard": 6, "4d": 6, "four_d": 6, "place": 6, "delai": 6, "except": 6, "satisfi": 6, "subclass": 6, "__torch_dispatch__": 6, "global_tensor": 6, "special": 6, "strictli": 6, "local_shard": 6, "xlashard": 6, "4e8e5511555073ce8b6d1a436bf808c9333dcac6": 6, "xla_sharded_tensor": 6, "l12": 6, "ongo": 6, "distributedtensor": 6, "prototyp": 6, "proof": 6, "concept": 6, "distribute_tensor": 6, "devicemesh": 6, "big_tensor": 6, "100000": 6, "my_dtensor": 6, "stai": 6, "tune": 6, "upcom": [6, 7], "_input_sharding_": 6, "field": 6, "input_mesh": 6, "librari": 6, "dedic": 6, "planner": 6, "spmdsaveplann": 6, "spmdloadplann": 6, "benefit": 6, "dist_cp": 6, "distributed_checkpoint": 6, "xc": 6, "storage_writ": 6, "filesystemwrit": 6, "checkpoint_dir": 6, "storage_read": 6, "filesystemread": 6, "manag": 6, "all_step": 6, "save_async": 6, "written": 6, "unblock": 6, "durat": 6, "preemption": 6, "detect": 6, "termin": 6, "provis": 6, "queuedresourc": 6, "autocheckpoint": 6, "chkpt_on_preempt": 6, "fsspec": 6, "filesystem": 6, "gc": 6, "prime_optim": 6, "chkpt_mgr": 6, "tracked_step": 6, "choos": 6, "highest": 6, "best_step": 6, "prime": 6, "present": 6, "attempt": 6, "unprim": 6, "fake": 6, "destruct": 6, "discov": 6, "_after": 6, "_the": 6, "unnecessari": 6, "forth": 6, "decis": 6, "hardcod": 6, "multi": 6, "resnet": 6, "leverag": 6, "num_gpu_machin": 6, "rank_of_current_machin": 6, "machine_0_ip_address": 6, "training_or_inference_script_using_spmd": 6, "xla_use_spmd": 6, "test_train_spmd_imagenet": 6, "0th": 6, "highli": 6, "named_paramet": 6, "conveni": 6, "quick": 6, "plai": 6, "512": 6, "throughput": 6, "am": 6, "roughli": 6, "4x": 6, "placement": 6, "visual": 6, "visualize_tensor_shard": 6, "visualize_shard": 6, "rich": 6, "2x2": 6, "generated_t": 6, "use_color": 6, "style": 6, "partial_repl": 6, "envvar": 6, "xla_auto_spmd": 6, "_tensor": 6, "distribute_modul": 6, "auto_polici": 6, "mymodul": 6, "sharded_model": 6, "behvaior": 6, "xla_auto_use_group_shard": 6, "reshard": 6, "xla_auto_spmd_mesh": 6, "unset": 6, "jit": 7, "unmodifi": 7, "hook": 7, "bridg": 7, "torchfx": 7, "technologi": 7, "fx": 7, "openxla": 7, "a_xla": 7, "b_xla": 7, "compiled_cod": 7, "resnet18": 7, "torchvis": 7, "eval_model": 7, "xla_resnet18": 7, "eval": 7, "dynamo_resnet18": 7, "no_grad": 7, "resent18": 7, "binari": 7, "analysi": 7, "bench": 7, "59": 7, "resnext50_32x4d": 7, "91": 7, "alexnet": 7, "28": 7, "mobilenet_v2": 7, "18": 7, "mnasnet1_0": 7, "68": 7, "vgg16": 7, "bert_pytorch": 7, "squeezenet1_1": 7, "timm_vision_transform": 7, "52": 7, "geomean": 7, "team": 7, "train_model": 7, "crossentropyloss": 7, "pred": 7, "train_model_main": 7, "dynamo_train_model": 7, "xla_optim": 7, "weight_decai": 7, "extract": 7, "07": 7, "81": 7, "87": 7, "fwd": 7, "bwd": 7, "e2": 7, "hide": 7, "cost": 7, "scenario": 7, "promis": 7, "complex": 7, "tradit": 7, "seen": 7, "expand": 7, "excit": 7, "invest": 7, "upstream": 7, "matur": 7, "stori": 7}, "objects": {"": [[2, 0, 0, "-", "torch_xla"]], "torch_xla.core": [[2, 0, 0, "-", "xla_model"]], "torch_xla.core.xla_model": [[2, 1, 1, "", "add_step_closure"], [2, 1, 1, "", "all_gather"], [2, 1, 1, "", "all_reduce"], [2, 1, 1, "", "all_to_all"], [2, 1, 1, "", "get_memory_info"], [2, 1, 1, "", "get_rng_state"], [2, 1, 1, "", "get_stablehlo"], [2, 1, 1, "", "get_stablehlo_bytecode"], [2, 1, 1, "", "is_master_ordinal"], [2, 1, 1, "", "mesh_reduce"], [2, 1, 1, "", "optimizer_step"], [2, 1, 1, "", "rendezvous"], [2, 1, 1, "", "save"], [2, 1, 1, "", "set_rng_state"], [2, 1, 1, "", "wait_device_ops"], [2, 1, 1, "", "xla_device"], [2, 1, 1, "", "xla_device_hw"]], "torch_xla.debug": [[2, 0, 0, "-", "metrics"]], "torch_xla.debug.metrics": [[2, 1, 1, "", "counter_names"], [2, 1, 1, "", "counter_value"], [2, 1, 1, "", "metric_data"], [2, 1, 1, "", "metric_names"], [2, 1, 1, "", "metrics_report"], [2, 1, 1, "", "short_metrics_report"]], "torch_xla": [[2, 1, 1, "", "device"], [2, 1, 1, "", "device_count"], [2, 1, 1, "", "devices"], [2, 0, 0, "-", "experimental"], [2, 0, 0, "-", "runtime"], [2, 1, 1, "", "step"], [2, 1, 1, "", "sync"]], "torch_xla.distributed": [[2, 0, 0, "-", "parallel_loader"], [2, 0, 0, "-", "spmd"], [2, 0, 0, "-", "xla_multiprocessing"]], "torch_xla.distributed.parallel_loader": [[2, 2, 1, "", "ParallelLoader"]], "torch_xla.distributed.parallel_loader.ParallelLoader": [[2, 3, 1, "", "per_device_loader"]], "torch_xla.distributed.spmd": [[2, 2, 1, "", "HybridMesh"], [2, 2, 1, "", "Mesh"], [2, 2, 1, "", "ShardingSpec"], [2, 1, 1, "", "clear_sharding"], [2, 1, 1, "", "get_global_mesh"], [2, 1, 1, "", "mark_sharding"], [2, 1, 1, "", "set_global_mesh"]], "torch_xla.distributed.xla_multiprocessing": [[2, 1, 1, "", "spawn"]], "torch_xla.experimental": [[2, 1, 1, "", "compile"], [2, 1, 1, "", "eager_mode"]], "torch_xla.runtime": [[2, 1, 1, "", "addressable_device_count"], [2, 1, 1, "", "device_type"], [2, 1, 1, "", "get_master_ip"], [2, 1, 1, "", "global_device_count"], [2, 1, 1, "", "global_ordinal"], [2, 1, 1, "", "global_runtime_device_count"], [2, 1, 1, "", "initialize_cache"], [2, 1, 1, "", "is_spmd"], [2, 1, 1, "", "local_device_count"], [2, 1, 1, "", "local_ordinal"], [2, 1, 1, "", "local_process_count"], [2, 1, 1, "", "use_spmd"], [2, 1, 1, "", "world_size"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "titleterms": {"troubleshoot": 0, "saniti": 0, "check": [0, 1], "pytorch": [0, 1, 2, 3, 6, 7], "xla": [0, 1, 2, 3, 6, 7], "version": 0, "perform": [0, 5], "A": 0, "simpl": [0, 1, 6], "calcul": 0, "run": [0, 1, 2, 6], "resnet": [0, 3], "With": 0, "fake": [0, 3], "data": [0, 3, 6], "debug": [0, 2, 6], "tool": [0, 6], "auto": [0, 6], "metric": 0, "analysi": 0, "compil": [0, 2, 7], "execut": 0, "get": 0, "report": 0, "understand": 0, "The": 0, "clear": 0, "dynamo": 0, "profil": 0, "benchmark": [0, 3], "known": 0, "caveat": 0, "tensor": [0, 2, 4], "quirk": 0, "more": 0, "environ": [0, 1], "variabl": [0, 1], "common": 0, "combin": 0, "reproduc": 0, "ci": 0, "cd": 0, "unit": 0, "test": 0, "failur": 0, "how": [1, 3], "gpu": [1, 5, 6], "creat": [1, 2], "instanc": 1, "setup": 1, "docker": [1, 5], "wheel": 1, "model": [1, 2], "amp": 1, "automat": 1, "mix": 1, "precis": 1, "develop": 1, "build": 1, "from": [1, 2, 4, 5], "sourc": [1, 4], "support": 1, "document": 2, "doc": 2, "devic": [2, 6], "an": 2, "ar": 2, "singl": [2, 5], "multipl": 2, "multi": [2, 5], "process": [2, 6], "tpu": [2, 3, 5, 6], "pod": [2, 3, 5, 6], "deep": 2, "dive": 2, "lazi": 2, "bfloat16": 2, "memori": 2, "layout": 2, "move": 2, "cpu": [2, 5], "save": 2, "load": [2, 6], "cach": 2, "further": 2, "read": 2, "api": [2, 6], "torch_xla": [2, 4], "runtim": [2, 5], "xla_model": 2, "distribut": [2, 5, 6], "spmd": [2, 6], "experiment": 2, "do": 3, "distributeddataparallel": 3, "background": 3, "motiv": 3, "us": [3, 4, 6], "resnet50": [3, 6], "mnist": 3, "real": [3, 4], "disclaim": 3, "fulli": [3, 6], "shard": [3, 6], "parallel": [3, 6], "fsdp": [3, 6], "exampl": [3, 6], "train": [3, 5, 7], "script": 3, "imagenet": 3, "instal": 3, "clone": 3, "repo": 3, "v3": [3, 5], "8": 3, "50": 3, "10": 3, "billion": 3, "paramet": 3, "recompil": 4, "let": 4, "": 4, "first": 4, "start": 4, "some": 4, "fact": 4, "constraint": 4, "1": 4, "input": 4, "dataset": 4, "2": 4, "oper": 4, "output": 4, "bound": 4, "dynam": 4, "shape": 4, "can": 4, "fix": 4, "case": 4, "when": 4, "you": 4, "without": 4, "queri": 4, "its": 4, "dimens": 4, "what": [4, 6], "i": [4, 6], "3": 4, "control": 4, "flow": 4, "conclus": 4, "appendix": 4, "pjrt": 5, "tl": 5, "dr": 5, "benefit": 5, "quickstart": 5, "node": 5, "differ": 5, "xrt": 5, "multithread": 5, "v2": 5, "chang": 5, "xm": 5, "rendezv": 5, "torch": [5, 7], "new": 5, "user": 6, "guid": 6, "design": 6, "overview": 6, "aannot": 6, "mesh": 6, "hybrid": 6, "partit": 6, "spec": 6, "xlashardedtensor": 6, "dtensor": 6, "integr": [6, 7], "awar": 6, "host": 6, "checkpoint": 6, "checkpointmanag": 6, "restor": 6, "optim": 6, "state": 6, "group": 6, "virtual": 6, "number": 6, "refer": 6, "express": 6, "torchdynamo": 7, "infer": 7, "featur": 7, "gap": 7, "take": 7, "awai": 7}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"Troubleshooting": [[0, "troubleshooting"]], "Sanity Check": [[0, "sanity-check"]], "Check PyTorch/XLA Version": [[0, "check-pytorch-xla-version"]], "Perform A Simple Calculation": [[0, "perform-a-simple-calculation"]], "Run Resnet With Fake Data": [[0, "run-resnet-with-fake-data"]], "Performance Debugging": [[0, "performance-debugging"]], "PyTorch/XLA Debugging Tool": [[0, "pytorch-xla-debugging-tool"]], "Perform A Auto-Metrics Analysis": [[0, "perform-a-auto-metrics-analysis"]], "Compilation & Execution Analysis": [[0, "compilation-execution-analysis"]], "Get A Metrics Report": [[0, "get-a-metrics-report"]], "Understand The Metrics Report": [[0, "understand-the-metrics-report"]], "Clear The Metrics Report": [[0, "clear-the-metrics-report"]], "PyTorch/XLA + Dynamo Debugging Tool": [[0, "pytorch-xla-dynamo-debugging-tool"]], "Performance Profiling": [[0, "performance-profiling"]], "Simple Benchmarking": [[0, "simple-benchmarking"]], "Known Performance Caveats": [[0, "known-performance-caveats"]], "XLA Tensor Quirks": [[0, "xla-tensor-quirks"]], "More Debugging Tools": [[0, "more-debugging-tools"]], "Environment Variables": [[0, "environment-variables"]], "Common Debugging Environment Variables Combinations": [[0, "common-debugging-environment-variables-combinations"]], "Reproducing PyTorch/XLA CI/CD unit test failures.": [[0, "reproducing-pytorch-xla-ci-cd-unit-test-failures"]], "How to run with PyTorch/XLA:GPU": [[1, "how-to-run-with-pytorch-xla-gpu"]], "Create a GPU instance": [[1, "create-a-gpu-instance"]], "Environment Setup": [[1, "environment-setup"]], "Docker": [[1, "docker"], [5, "docker"]], "Check environment variable": [[1, "check-environment-variable"]], "Wheel": [[1, "wheel"]], "Run a simple model": [[1, "run-a-simple-model"]], "AMP (AUTOMATIC MIXED PRECISION)": [[1, "amp-automatic-mixed-precision"]], "Develop PyTorch/XLA on a GPU instance (build PyTorch/XLA from source with GPU support)": [[1, "develop-pytorch-xla-on-a-gpu-instance-build-pytorch-xla-from-source-with-gpu-support"]], "PyTorch/XLA documentation": [[2, "pytorch-xla-documentation"]], "Docs": [[2, null]], "PyTorch on XLA Devices": [[2, "pytorch-on-xla-devices"]], "Creating an XLA Tensor": [[2, "creating-an-xla-tensor"]], "XLA Tensors are PyTorch Tensors": [[2, "xla-tensors-are-pytorch-tensors"]], "Running Models on XLA Devices": [[2, "running-models-on-xla-devices"]], "Running on a Single XLA Device": [[2, "running-on-a-single-xla-device"]], "Running on Multiple XLA Devices with Multi-processing": [[2, "running-on-multiple-xla-devices-with-multi-processing"]], "Running on TPU Pods": [[2, "running-on-tpu-pods"]], "XLA Tensor Deep Dive": [[2, "id3"]], "XLA Tensors are Lazy": [[2, "xla-tensors-are-lazy"]], "XLA Tensors and bFloat16": [[2, "xla-tensors-and-bfloat16"]], "Memory Layout": [[2, "memory-layout"]], "Moving XLA Tensors to and from the CPU": [[2, "moving-xla-tensors-to-and-from-the-cpu"]], "Saving and Loading XLA Tensors": [[2, "saving-and-loading-xla-tensors"]], "Compilation Caching": [[2, "compilation-caching"]], "Further Reading": [[2, "further-reading"]], "PyTorch/XLA API": [[2, "pytorch-xla-api"]], "torch_xla": [[2, "module-torch_xla"]], "runtime": [[2, "module-torch_xla.runtime"]], "xla_model": [[2, "module-torch_xla.core.xla_model"]], "distributed": [[2, "module-torch_xla.distributed.parallel_loader"]], "spmd": [[2, "module-torch_xla.distributed.spmd"]], "experimental": [[2, "module-torch_xla.experimental"]], "debug": [[2, "module-torch_xla.debug.metrics"]], "How to do DistributedDataParallel": [[3, "how-to-do-distributeddataparallel"]], "Background / Motivation": [[3, "background-motivation"]], "How to use DistributedDataParallel": [[3, "how-to-use-distributeddataparallel"]], "Benchmarking": [[3, "benchmarking"]], "Resnet50 with fake data": [[3, "resnet50-with-fake-data"]], "MNIST with fake data": [[3, "mnist-with-fake-data"]], "MNIST with real data": [[3, "mnist-with-real-data"]], "Disclaimer": [[3, "disclaimer"]], "Fully Sharded Data Parallel (FSDP) in PyTorch XLA": [[3, "fully-sharded-data-parallel-fsdp-in-pytorch-xla"]], "Example training scripts on MNIST and ImageNet": [[3, "example-training-scripts-on-mnist-and-imagenet"]], "Installation": [[3, "installation"]], "Clone PyTorch/XLA repo": [[3, "clone-pytorch-xla-repo"]], "Train MNIST on v3-8 TPU": [[3, "train-mnist-on-v3-8-tpu"]], "Train ImageNet with ResNet-50 on v3-8 TPU": [[3, "train-imagenet-with-resnet-50-on-v3-8-tpu"]], "Example training scripts on TPU pod (with 10 billion parameters)": [[3, "example-training-scripts-on-tpu-pod-with-10-billion-parameters"]], "Source of recompilations in torch_xla": [[4, "source-of-recompilations-in-torch-xla"]], "Let\u2019s first start with some facts/constraints:": [[4, "lets-first-start-with-some-facts-constraints"]], "#1. From input dataset.": [[4, "from-input-dataset"]], "#2. From operator output": [[4, "from-operator-output"]], "2.1 Bounded dynamic shape can fix the case when you use the tensor with dynamic shape as a Tensor, without querying its real dimension.": [[4, "bounded-dynamic-shape-can-fix-the-case-when-you-use-the-tensor-with-dynamic-shape-as-a-tensor-without-querying-its-real-dimension"]], "2.2 what if real dimension is queried on a tensor with dynamic shape?": [[4, "what-if-real-dimension-is-queried-on-a-tensor-with-dynamic-shape"]], "#3. From control flow": [[4, "from-control-flow"]], "Conclusion:": [[4, "conclusion"]], "Appendix:": [[4, "appendix"]], "PJRT Runtime": [[5, "pjrt-runtime"]], "TL;DR": [[5, "tl-dr"]], "Benefits": [[5, "benefits"]], "Quickstart": [[5, "quickstart"]], "CPU": [[5, "cpu"]], "TPU": [[5, "tpu"]], "Pods": [[5, "pods"]], "GPU": [[5, "gpu"]], "Single-node GPU training": [[5, "single-node-gpu-training"]], "Multi-node GPU training": [[5, "multi-node-gpu-training"]], "Differences from XRT": [[5, "differences-from-xrt"]], "Multithreading on TPU v2/v3": [[5, "id3"]], "Changes to xm.rendezvous": [[5, "changes-to-xm-rendezvous"]], "PJRT and torch.distributed": [[5, "pjrt-and-torch-distributed"]], "Performance": [[5, "performance"]], "New TPU runtime": [[5, "new-tpu-runtime"]], "PyTorch/XLA SPMD User Guide": [[6, "pytorch-xla-spmd-user-guide"]], "What is PyTorch/XLA SPMD?": [[6, "what-is-pytorch-xla-spmd"]], "PyTorch/XLA SPMD Design Overview": [[6, "pytorch-xla-spmd-design-overview"]], "Simple Example & Sharding Aannotation API": [[6, "simple-example-sharding-aannotation-api"]], "Mesh": [[6, "id4"]], "Hybrid Mesh": [[6, "hybrid-mesh"]], "Partition Spec": [[6, "id5"]], "XLAShardedTensor": [[6, "xlashardedtensor"]], "DTensor Integration": [[6, "dtensor-integration"]], "Sharding-Aware Host-to-Device Data Loading": [[6, "sharding-aware-host-to-device-data-loading"]], "Distributed Checkpointing": [[6, "distributed-checkpointing"]], "CheckpointManager": [[6, "checkpointmanager"]], "Restoring Optimizer State": [[6, "restoring-optimizer-state"]], "Process Groups": [[6, "process-groups"]], "Virtual Device Optimization": [[6, "virtual-device-optimization"]], "Number of processes": [[6, "number-of-processes"]], "Running SPMD on TPU Pod": [[6, "running-spmd-on-tpu-pod"]], "Running SPMD on GPU": [[6, "running-spmd-on-gpu"]], "Reference Examples": [[6, "reference-examples"]], "Use SPMD to express Data Parallel": [[6, "use-spmd-to-express-data-parallel"]], "Use SPMD to express FSDP(Fully Sharded Data Parallel)": [[6, "use-spmd-to-express-fsdp-fully-sharded-data-parallel"]], "Running Resnet50 example with SPMD": [[6, "running-resnet50-example-with-spmd"]], "SPMD Debugging Tool": [[6, "spmd-debugging-tool"]], "Auto-Sharding": [[6, "auto-sharding"]], "TorchDynamo(torch.compile) integration in PyTorch XLA": [[7, "torchdynamo-torch-compile-integration-in-pytorch-xla"]], "Integration": [[7, "integration"]], "Inference": [[7, "inference"]], "Training": [[7, "training"]], "Feature gaps": [[7, "feature-gaps"]], "Take away": [[7, "take-away"]]}, "indexentries": {"hybridmesh (class in torch_xla.distributed.spmd)": [[2, "torch_xla.distributed.spmd.HybridMesh"]], "mesh (class in torch_xla.distributed.spmd)": [[2, "torch_xla.distributed.spmd.Mesh"]], "parallelloader (class in torch_xla.distributed.parallel_loader)": [[2, "torch_xla.distributed.parallel_loader.ParallelLoader"]], "shardingspec (class in torch_xla.distributed.spmd)": [[2, "torch_xla.distributed.spmd.ShardingSpec"]], "add_step_closure() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.add_step_closure"]], "addressable_device_count() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.addressable_device_count"]], "all_gather() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.all_gather"]], "all_reduce() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.all_reduce"]], "all_to_all() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.all_to_all"]], "clear_sharding() (in module torch_xla.distributed.spmd)": [[2, "torch_xla.distributed.spmd.clear_sharding"]], "compile() (in module torch_xla.experimental)": [[2, "torch_xla.experimental.compile"]], "counter_names() (in module torch_xla.debug.metrics)": [[2, "torch_xla.debug.metrics.counter_names"]], "counter_value() (in module torch_xla.debug.metrics)": [[2, "torch_xla.debug.metrics.counter_value"]], "device() (in module torch_xla)": [[2, "torch_xla.device"]], "device_count() (in module torch_xla)": [[2, "torch_xla.device_count"]], "device_type() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.device_type"]], "devices() (in module torch_xla)": [[2, "torch_xla.devices"]], "eager_mode() (in module torch_xla.experimental)": [[2, "torch_xla.experimental.eager_mode"]], "get_global_mesh() (in module torch_xla.distributed.spmd)": [[2, "torch_xla.distributed.spmd.get_global_mesh"]], "get_master_ip() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.get_master_ip"]], "get_memory_info() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.get_memory_info"]], "get_rng_state() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.get_rng_state"]], "get_stablehlo() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.get_stablehlo"]], "get_stablehlo_bytecode() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.get_stablehlo_bytecode"]], "global_device_count() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.global_device_count"]], "global_ordinal() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.global_ordinal"]], "global_runtime_device_count() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.global_runtime_device_count"]], "initialize_cache() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.initialize_cache"]], "is_master_ordinal() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.is_master_ordinal"]], "is_spmd() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.is_spmd"]], "local_device_count() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.local_device_count"]], "local_ordinal() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.local_ordinal"]], "local_process_count() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.local_process_count"]], "mark_sharding() (in module torch_xla.distributed.spmd)": [[2, "torch_xla.distributed.spmd.mark_sharding"]], "mesh_reduce() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.mesh_reduce"]], "metric_data() (in module torch_xla.debug.metrics)": [[2, "torch_xla.debug.metrics.metric_data"]], "metric_names() (in module torch_xla.debug.metrics)": [[2, "torch_xla.debug.metrics.metric_names"]], "metrics_report() (in module torch_xla.debug.metrics)": [[2, "torch_xla.debug.metrics.metrics_report"]], "module": [[2, "module-torch_xla"], [2, "module-torch_xla.core.xla_model"], [2, "module-torch_xla.debug.metrics"], [2, "module-torch_xla.distributed.parallel_loader"], [2, "module-torch_xla.distributed.spmd"], [2, "module-torch_xla.distributed.xla_multiprocessing"], [2, "module-torch_xla.experimental"], [2, "module-torch_xla.runtime"]], "optimizer_step() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.optimizer_step"]], "per_device_loader() (torch_xla.distributed.parallel_loader.parallelloader method)": [[2, "torch_xla.distributed.parallel_loader.ParallelLoader.per_device_loader"]], "rendezvous() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.rendezvous"]], "save() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.save"]], "set_global_mesh() (in module torch_xla.distributed.spmd)": [[2, "torch_xla.distributed.spmd.set_global_mesh"]], "set_rng_state() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.set_rng_state"]], "short_metrics_report() (in module torch_xla.debug.metrics)": [[2, "torch_xla.debug.metrics.short_metrics_report"]], "spawn() (in module torch_xla.distributed.xla_multiprocessing)": [[2, "torch_xla.distributed.xla_multiprocessing.spawn"]], "step() (in module torch_xla)": [[2, "torch_xla.step"]], "sync() (in module torch_xla)": [[2, "torch_xla.sync"]], "torch_xla": [[2, "module-torch_xla"]], "torch_xla.core.xla_model": [[2, "module-torch_xla.core.xla_model"]], "torch_xla.debug.metrics": [[2, "module-torch_xla.debug.metrics"]], "torch_xla.distributed.parallel_loader": [[2, "module-torch_xla.distributed.parallel_loader"]], "torch_xla.distributed.spmd": [[2, "module-torch_xla.distributed.spmd"]], "torch_xla.distributed.xla_multiprocessing": [[2, "module-torch_xla.distributed.xla_multiprocessing"]], "torch_xla.experimental": [[2, "module-torch_xla.experimental"]], "torch_xla.runtime": [[2, "module-torch_xla.runtime"]], "use_spmd() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.use_spmd"]], "wait_device_ops() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.wait_device_ops"]], "world_size() (in module torch_xla.runtime)": [[2, "torch_xla.runtime.world_size"]], "xla_device() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.xla_device"]], "xla_device_hw() (in module torch_xla.core.xla_model)": [[2, "torch_xla.core.xla_model.xla_device_hw"]]}})